---
title: CTF Cheatsheet
date: 2024-01-26
categories: [Cheatsheet, CTF]
tags: [cheatsheet, ctf, capturetheflag, reverse-shell, shell, rce, hash, script, python, john, hashcat, suid]
img_path: /assets/cheatsheet
published: true
image:
    path: cheatsheetCover.png
---

> _Image taken from [CTF-CheatSheet](https://github.com/Rajchowdhury420/CTF-CheatSheet)._

## Shell stabilization

```bash
# shell stabilization using script
$ which script
which script
/usr/bin/script
$ script -O /dev/null -q /bin/bash
script -O /dev/null -q /bin/bash
$ bash
bash
$ ^Z
[1]+  Stopped                 nc -lvnp 1337

┌──(kali㉿CSpanias)-[~]
└─$ stty raw -echo; fg
nc -lvnp 1337

www-data@50bca5e748b0:/var/www/html$
```

```bash
# shell stabilization with Python
$ python3 -c 'import.pty;pty.spawn("/bin/bash")'
$ ^Z
[1]+  Stopped                 nc -lvnp 1337
# background shell
┌──(kali㉿CSpanias)-[~]
└─$ stty raw -echo; fg
```

Get values for the `rows` and `cols` variables from our attack host:

```bash
# get attack host's shell rows and cols values
$ stty -a
speed 38400 baud; rows 51; columns 209; line = 0;
<SNIP>
```

Set the same values on target:

```bash
www-data@50bca5e748b0:/var/www/html$ stty rows 51 cols 209
www-data@50bca5e748b0:/var/www/html$ export TERM=xterm
```

## Hash cracking

> [Hashcat-examples](https://hashcat.net/wiki/doku.php?id=example_hashes)

```bash
# using hashcat's autodetect mode ('--username' if hashes are in <name:hash> format)
$ hashcat <hashes> /usr/share/wordlists/rockyou.txt --username
# brute-force hashes using the mode found
$ hashcat -m 3200 hashes /usr/share/wordlists/rockyou.txt --username
# show cracked hashes
$ hashcat -m 3200 --username --show hashes
```

```bash
# list formats
$ john --list=formats
# brute-force
john <hashes> --wordlist=/usr/share/wordlists/rockyou.txt
```

## File enumeration

### Linux

```bash
# search for SUID files
$ find / -perm -4000 2>/dev/null
$ find / -perm -u=s 2>/dev/null
```

If machine has a web server, check for database configuration files:

```bash
# searching for configuration files
/var/www/html$ find . | grep config
# searching for database-related strings within the configuration file
/var/www/html$ grep database <filePath>
```